<!DOCTYPE html>
<html>

<head>
  <title>Test Reporter</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u"
        crossorigin="anonymous">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/paper/bootstrap.min.css">
  <%= csrf_meta_tags %>
  <%= stylesheet_link_tag    'application', media: 'all', 'data-turbolinks-track': 'reload' %>
  <%= javascript_include_tag 'application', 'data-turbolinks-track': 'reload' %>
  <!--[if lt IE 9]>
  <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/r29/html5.min.js">
  </script>
  <![endif]-->

  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

  <script src="//cdnjs.cloudflare.com/ajax/libs/angular.js/1.1.5/angular.min.js"></script>

  <style type="text/css">
    @charset "UTF-8";

    .service-stats-passed {
      color: green;
      font-weight: bold;
    }

    .service-stats-failed {
      color: red;
      font-weight: bold;
    }



    table {
      border: 2px solid steelblue;
      table-layout: fixed;
    }
    th, td {
      padding: 1px;
      border: 1px solid steelblue;
    }
    th {
      text-align: center;
    }

    .passed {color: green;}
    .failed {color: red;}
    .info {color: #487dce;}
    .lively {
      color: steelblue;
      background-color: #e2e2e2;
      border: solid darkslateblue 1px;
      font-size: large;
    }
    .fixit {
      position: fixed;
      top: 2%;
      right: 10%;
    }

</style>

</head>

<body bgcolor="#67BCDB" ng-app>

<div class="container">
  <div class="page-header">
    <h1>Test Reports</h1>
  </div>
  <p class="lead">List of last 10 days test reports generated by Cucumber. For older reports please check S3 folder.</p>
</div>
<div class="fixit">
  <%= link_to reports_path do %>
    <span ><%= image_tag 'Home.png', width: 50, height: 50, alt:"Home"%><p align="center">Home</p></span>
  <% end %>
</div>

<div class="container">
  <div>
    <table style="width:100%">
      <thead>
      <tr>
        <th style="width: 20%">Tag</th>
        <th style="width: 20%">Critical</th>
        <th style="width: 20%">Rerun</th>
        <th style="width: 20%">Non-Critical</th>
        <th style="width: 20%">Travis Run</th>
      </tr>
      </thead>
      <tbody>
      <% @project.each do |run_date, data| %>
        <table style="width:100%" >
          <thead>
          <tr>
            <th colspan="5" bgcolor="#e6f2ff" style="padding: 1px; width: 100%"><%= run_date %></th>
          </tr>
          </thead>
          <tbody>
          <% data.each do |tag, details| %>
              <% critical = ReportsHelper.getStats(details['critical']) %>
              <% rerun = ReportsHelper.getStats(details['rerun']) %>
              <% non_critical = ReportsHelper.getStats(details['non-critical']) %>
              <% travis_url = ReportsHelper.build_travis_details(details) %>
            <tr>
              <td style="width: 20%"><strong><%= tag.split('_').map(&:capitalize).join(' ')%></strong></td>
              <td style="width: 20%">
                <%= link_to show_report_url(date: run_date, service: 'critical', type: tag), target: :_blank do%>
                  <span class="passed"><%= critical[:passed]%></span> / <span class="failed"><%=  critical[:failed] %></span>
                <% end %>
              </td>
              <td style="width: 20%">
                <%= link_to show_report_url(date: run_date, service: 'rerun', type: tag), target: :_blank do%>
                    <span class="passed"><%= rerun[:passed]%></span> / <span class="failed"><%=  rerun[:failed] %></span>
                <% end %>
              </td>
              <td style="width: 20%">
                <%= link_to show_report_url(date: run_date, service: 'non-critical', type: tag), target: :_blank do%>
                    <span class="passed"><%= non_critical[:passed]%></span> / <span class="failed"><%=  non_critical[:failed] %></span>
                <% end %>
              </td>
              <td style="width: 20%; word-wrap: break-word">
                <%= link_to travis_url[:url], target: :_blank do%>
                  <span class="info"> <%= travis_url[:text]  %></span>
                <% end %>
              </td>
            </tr>

          <% end %>
          </tbody>
        </table>
      <% end %>
      </tbody>
    </table>
  </div>
</div>

<%#<footer class="footer">
    <div class="container">
      <p class="text-muted">Place sticky footer content here.</p>
    </div>
  </footer>%>

</body>
</html>
